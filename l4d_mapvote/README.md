# 求生之路1&2 投票换图插件

适用于服务端的投票换图插件，可以用来更换三方图，地图需自己在**data/l4d_mapvote.cfg**中添加。  
投票模式有菜单投票和游戏内置投票两种模式，使用游戏内置投票需要安装builtinvotes扩展。  
插件编写参考了SilverShot的l4d_votemode。

**支持游戏：求生之路1&2**（实际上游戏1代我没测试过，应该也是支持的）  
**建议插件平台：SourceMod 1.10.0**

## 指令与功能

- **!mapvote**  
  打开投票地图菜单。非管理员也可以使用。
- **!mapveto**  
  直接否定当前的投票。仅具有ROOT权限管理员可用。
- **!mappass**  
  直接通过当前的投票。仅具有ROOT权限管理员可用。
- **!mapchange**  
  打开更换地图菜单，使用此指令换图无需经过投票。仅具有ROOT权限管理员可用。

配置文件cfg/sourcemod/l4d_mapvote.cfg中可更改投票持续时间、更换地图延时、地图检查开关、投票模式。

## 游戏模式检测

本插件可以根据当前的基础游戏模式来完成一些特殊的动作。

### 定义地图列表游戏模式

在data/l4d_mapvote.cfg写入地图时，在一组地图列表的第一项写入：

> "\_BASEMODE\_"		"1"

这样在游戏中，当前游戏模式若是基于战役模式，打开地图列表就会直接显示该组地图。  
\_BASEMODE\_可以设置为1~4，具体含义如下：

1. 基于战役模式
2. 基于对抗模式
3. 基于生还者模式
4. 基于清道夫模式

多个地图列表中设置\_BASEMODE\_为同一值，只有最后一个有效。

### 更改游戏模式

如果你允许插件更改游戏模式，那么当更换指定地图的模式与当前游戏模式不符时，插件会同时更改游戏模式和地图。  
比如在基于战役的模式下更换为基于对抗地图列表中的地图，插件会将游戏模式修改为普通对抗模式。